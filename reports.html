<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - Hotel CRM</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            overflow-y: auto;
            scrollbar-width: none;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8fafc;
            color: #1e293b;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0 24px;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 250px;
            right: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: #0f172a;
        }

        .breadcrumb {
            color: #64748b;
            font-size: 14px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            border: 1px solid transparent;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #f8fafc;
            color: #374151;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f1f5f9;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            background: white;
            border-right: 1px solid #e2e8f0;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 200;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: #0f172a;
        }

        .property-selector {
            margin: 16px;
            padding: 12px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .property-label {
            font-size: 12px;
            color: #64748b;
            margin-bottom: 4px;
        }

        .property-name {
            font-size: 14px;
            font-weight: 500;
            color: #0f172a;
        }

        .nav-menu {
            padding: 8px;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            padding: 0 12px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            margin-bottom: 2px;
            border-radius: 6px;
            color: #64748b;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
        }

        .nav-item:hover {
            background: #f1f5f9;
            color: #0f172a;
        }

        .nav-item.active {
            background: #eff6ff;
            color: #2563eb;
            border: 1px solid #bfdbfe;
        }

        .nav-item i {
            width: 18px;
            text-align: center;
        }

        .main-content {
            margin-left: 250px;
            margin-top: 64px;
            padding: 24px;
            min-height: calc(100vh - 64px);
        }

        .reports-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .report-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .report-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .report-info h3 {
            font-size: 18px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .report-info p {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 16px;
        }

        .report-actions {
            display: flex;
            gap: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-large {
            max-width: 1200px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #0f172a;
        }

        .close-btn {
            background: none;
            border: none;
            color: #64748b;
            cursor: pointer;
            font-size: 24px;
            padding: 4px 8px;
        }

        .close-btn:hover {
            background: #f1f5f9;
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .period-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .period-btn {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-weight: 500;
        }

        .period-btn:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .period-btn.active {
            border-color: #3b82f6;
            background: #3b82f6;
            color: white;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        .print-preview {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
        }

        .report-header-print {
            text-align: center;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 2px solid #3b82f6;
        }

        .report-header-print h2 {
            font-size: 28px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .report-header-print .subtitle {
            font-size: 16px;
            color: #64748b;
            margin: 4px 0;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .stat-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: #64748b;
            text-transform: uppercase;
        }

        .section {
            margin: 32px 0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        .bookings-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .bookings-table th,
        .bookings-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
            font-size: 13px;
        }

        .bookings-table th {
            background: #f8fafc;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            font-size: 11px;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-confirmed {
            background: #dcfce7;
            color: #166534;
        }

        .status-checked-in {
            background: #dbeafe;
            color: #1e40af;
        }

        .status-checked-out {
            background: #f3f4f6;
            color: #374151;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
        }

        @media print {
            body {
                background: white;
                margin: 0;
                padding: 0;
            }
            
            /* Ẩn tất cả các phần không cần thiết */
            .sidebar, 
            .header, 
            .toolbar, 
            .modal-actions, 
            .reports-grid, 
            .breadcrumb,
            .form-group,
            .period-options,
            .modal-header {
                display: none !important;
            }
            
            .main-content {
                margin: 0;
                padding: 0;
            }
            
            .modal {
                position: static;
                display: block !important;
                background: white;
            }
            
            .modal-content {
                max-width: 100%;
                width: 100%;
                padding: 0;
                box-shadow: none;
                max-height: none;
                overflow: visible;
            }
            
            .print-preview {
                border: none;
                padding: 30px;
                margin: 0;
                background: white;
            }
            
            /* Cải thiện header báo cáo */
            .report-header-print {
                page-break-after: avoid;
                margin-bottom: 30px;
                padding-bottom: 15px;
            }
            
            .report-header-print h2 {
                font-size: 24px;
                margin-bottom: 8px;
            }
            
            .report-header-print .subtitle {
                font-size: 13px;
            }
            
            /* Cải thiện phần thống kê - hiển thị ngang 1 hàng */
            .stats-summary {
                display: table;
                width: 100%;
                page-break-inside: avoid;
                margin: 20px 0;
                border-collapse: collapse;
            }
            
            .stat-box {
                display: table-cell;
                background: white;
                border: 1px solid #e2e8f0;
                padding: 15px;
                text-align: center;
                vertical-align: middle;
            }
            
            .stat-value {
                font-size: 20px;
                font-weight: 700;
                color: #0f172a;
                margin-bottom: 4px;
            }
            
            .stat-label {
                font-size: 11px;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            /* Cải thiện bảng */
            .section {
                page-break-inside: avoid;
                margin: 25px 0;
            }
            
            .section-title {
                font-size: 16px;
                margin-bottom: 12px;
                padding-bottom: 6px;
            }
            
            .bookings-table {
                page-break-inside: auto;
                font-size: 11px;
            }
            
            .bookings-table th,
            .bookings-table td {
                padding: 8px;
                font-size: 10px;
            }
            
            .bookings-table th {
                font-size: 9px;
            }
            
            .bookings-table tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
            
            /* Đảm bảo màu sắc khi in */
            .stat-box,
            .status-badge,
            .bookings-table th {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Định dạng trang A4 */
            @page {
                margin: 1.5cm;
                size: A4 portrait;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .header {
                left: 0;
            }
            .main-content {
                margin-left: 0;
            }
            .reports-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-hotel"></i>
                </div>
                <div class="logo-text">Hotel CRM</div>
            </div>
        </div>

        <div class="property-selector">
            <div class="property-label">Current Property</div>
            <div class="property-name">Demo Link Hotel</div>
        </div>

        <nav class="nav-menu">
            <div class="nav-section">
                <div class="nav-section-title">Main</div>
                <a class="nav-item" href="index.html">
                    <i class="fas fa-home"></i>
                    Dashboard
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Booking Management</div>
                <a class="nav-item" href="all-bookings.html">
                    <i class="fas fa-calendar-check"></i>
                    All Bookings
                </a>
                <a class="nav-item" href="payment.html">
                    <i class="fas fa-credit-card"></i>
                    Payment History
                </a>
                <a class="nav-item" href="calendar.html">
                    <i class="fas fa-calendar"></i>
                    Calendar View
                </a>
                <a class="nav-item" href="customer.html">
                    <i class="fas fa-users"></i>
                    Customers
                </a>
                <a class="nav-item" href="coupons.html"> 
                    <i class="fas fa-tags"></i>
                    Coupons
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Room Management</div>
                <a class="nav-item" href="room-types.html">
                    <i class="fas fa-door-open"></i>
                    Room Types
                </a>
                <a class="nav-item" href="rooms.html">
                    <i class="fas fa-bed"></i>
                    Rooms
                </a>
                <a class="nav-item" href="rate-pricing.html">
                    <i class="fas fa-dollar-sign"></i>
                    Rates & Pricing
                </a>
                <a class="nav-item" href="seasons.html">
                    <i class="fas fa-calendar-plus"></i>
                    Seasons
                </a>
                <a class="nav-item" href="services.html">
                    <i class="fas fa-concierge-bell"></i>
                    Services
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Operations</div>
                <a href="checkin.html" class="nav-item">
                    <i class="fas fa-sign-in-alt"></i>
                    Check-in
                </a>
                <a href="checkout.html" class="nav-item">
                    <i class="fas fa-sign-out-alt"></i>
                    Check-out
                </a>
                <a href="housekeeping.html" class="nav-item">
                    <i class="fas fa-broom"></i>
                    Housekeeping
                </a>
                <a href="maintenance.html" class="nav-item">
                    <i class="fas fa-tools"></i>
                    Maintenance
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Reports</div>
                <a href="analytics.html" class="nav-item">
                    <i class="fas fa-chart-bar"></i>
                    Analytics
                </a>
                <a href="revenue.html" class="nav-item">
                    <i class="fas fa-dollar-sign"></i>
                    Revenue
                </a>
                <a href="reports.html" class="nav-item active">
                    <i class="fas fa-file-alt"></i>
                    Reports
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-section-title">Settings</div>
                <a class="nav-item" href="booking-rules.html">
                    <i class="fas fa-gavel"></i>
                    Booking Rules
                </a>
                <a class="nav-item" href="taxes-fees.html">
                    <i class="fas fa-percentage"></i>
                    Taxes & Fees
                </a>
                <a class="nav-item" href="settings.html">
                    <i class="fas fa-cog"></i>
                    General Settings
                </a>
            </div>
        </nav>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <h1 class="page-title">Reports Center</h1>
            <div class="breadcrumb">Reports / Reports</div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="reports-grid">
            <!-- Booking Summary Report -->
            <div class="report-card" onclick="openBookingSummaryModal()">
                <div class="report-info">
                    <h3><i class="fas fa-calendar-check" style="color: #3b82f6;"></i> Booking Summary</h3>
                    <p>Comprehensive booking summaries by day, week, month, quarter, or year</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openBookingSummaryModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>

            <!-- Revenue Report -->
            <div class="report-card" onclick="openRevenueReportModal()">
                <div class="report-info">
                    <h3><i class="fas fa-dollar-sign" style="color: #10b981;"></i> Revenue Report</h3>
                    <p>Detailed revenue breakdown by room types, services, and payments</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openRevenueReportModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>

            <!-- Occupancy Report -->
            <div class="report-card" onclick="openOccupancyReportModal()">
                <div class="report-info">
                    <h3><i class="fas fa-bed" style="color: #f59e0b;"></i> Occupancy Report</h3>
                    <p>Room occupancy rates, availability trends, and performance metrics</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openOccupancyReportModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>

            <!-- Guest Analytics -->
            <div class="report-card" onclick="openGuestReportModal()">
                <div class="report-info">
                    <h3><i class="fas fa-users" style="color: #8b5cf6;"></i> Guest Analytics</h3>
                    <p>Guest demographics, preferences, loyalty, and satisfaction metrics</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openGuestReportModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>

            <!-- Operations Report -->
            <div class="report-card" onclick="openOperationsReportModal()">
                <div class="report-info">
                    <h3><i class="fas fa-tasks" style="color: #06b6d4;"></i> Operations Report</h3>
                    <p>Housekeeping efficiency, maintenance tracking, and operational KPIs</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openOperationsReportModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>

            <!-- Financial Summary -->
            <div class="report-card" onclick="openFinancialReportModal()">
                <div class="report-info">
                    <h3><i class="fas fa-chart-line" style="color: #ef4444;"></i> Financial Summary</h3>
                    <p>Comprehensive financial overview with P&L and cash flow analysis</p>
                </div>
                <div class="report-actions">
                    <button class="btn btn-primary" onclick="event.stopPropagation(); openFinancialReportModal()">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Booking Summary Modal -->
    <div class="modal" id="bookingSummaryModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Booking Summary Report</h3>
                <button class="close-btn" onclick="closeModal('bookingSummaryModal')">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label">Select Time Period</label>
                <div class="period-options">
                    <div class="period-btn active" onclick="selectPeriod('daily', this)">
                        <i class="fas fa-calendar-day"></i><br>Daily
                    </div>
                    <div class="period-btn" onclick="selectPeriod('weekly', this)">
                        <i class="fas fa-calendar-week"></i><br>Weekly
                    </div>
                    <div class="period-btn" onclick="selectPeriod('monthly', this)">
                        <i class="fas fa-calendar-alt"></i><br>Monthly
                    </div>
                    <div class="period-btn" onclick="selectPeriod('quarterly', this)">
                        <i class="fas fa-calendar"></i><br>Quarterly
                    </div>
                    <div class="period-btn" onclick="selectPeriod('yearly', this)">
                        <i class="fas fa-calendar-check"></i><br>Yearly
                    </div>
                </div>
            </div>

            <div class="toolbar">
                <div>
                    <button class="btn btn-secondary" onclick="generateBookingPreview()">
                        <i class="fas fa-eye"></i> Preview
                    </button>
                </div>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary" onclick="downloadBookingReport()">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="bookingReportContent">
                <!-- Report content will be generated here -->
            </div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('bookingSummaryModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Revenue Report Modal -->
    <div class="modal" id="revenueReportModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Revenue Report</h3>
                <button class="close-btn" onclick="closeModal('revenueReportModal')">&times;</button>
            </div>

            <div class="toolbar">
                <button class="btn btn-secondary" onclick="generateRevenuePreview()">
                    <i class="fas fa-eye"></i> Generate Preview
                </button>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="revenueReportContent"></div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('revenueReportModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Occupancy Report Modal -->
    <div class="modal" id="occupancyReportModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Occupancy Report</h3>
                <button class="close-btn" onclick="closeModal('occupancyReportModal')">&times;</button>
            </div>

            <div class="toolbar">
                <button class="btn btn-secondary" onclick="generateOccupancyPreview()">
                    <i class="fas fa-eye"></i> Generate Preview
                </button>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="occupancyReportContent"></div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('occupancyReportModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Guest Report Modal -->
    <div class="modal" id="guestReportModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Guest Analytics Report</h3>
                <button class="close-btn" onclick="closeModal('guestReportModal')">&times;</button>
            </div>

            <div class="toolbar">
                <button class="btn btn-secondary" onclick="generateGuestPreview()">
                    <i class="fas fa-eye"></i> Generate Preview
                </button>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="guestReportContent"></div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('guestReportModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Operations Report Modal -->
    <div class="modal" id="operationsReportModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Operations Report</h3>
                <button class="close-btn" onclick="closeModal('operationsReportModal')">&times;</button>
            </div>

            <div class="toolbar">
                <button class="btn btn-secondary" onclick="generateOperationsPreview()">
                    <i class="fas fa-eye"></i> Generate Preview
                </button>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="operationsReportContent"></div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('operationsReportModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Financial Report Modal -->
    <div class="modal" id="financialReportModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 class="modal-title">Financial Summary Report</h3>
                <button class="close-btn" onclick="closeModal('financialReportModal')">&times;</button>
            </div>

            <div class="toolbar">
                <button class="btn btn-secondary" onclick="generateFinancialPreview()">
                    <i class="fas fa-eye"></i> Generate Preview
                </button>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-secondary" onclick="window.print()">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button class="btn btn-primary">
                        <i class="fas fa-download"></i> Download PDF
                    </button>
                </div>
            </div>

            <div class="print-preview" id="financialReportContent"></div>

            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal('financialReportModal')">Close</button>
            </div>
        </div>
    </div>

    <script>
        let selectedPeriod = 'daily';

        // Sample booking data
        const bookingsData = {
            daily: [
                { id: 'BK001', guest: 'Emily Chen', room: '201', type: 'Deluxe Ocean Suite', checkIn: 'Dec 25, 2024', checkOut: 'Dec 28, 2024', nights: 3, amount: 850, status: 'confirmed' },
                { id: 'BK002', guest: 'Michael Brown', room: '105', type: 'Standard Room', checkIn: 'Dec 25, 2024', checkOut: 'Dec 26, 2024', nights: 1, amount: 150, status: 'checked-in' },
                { id: 'BK003', guest: 'Sarah Johnson', room: '302', type: 'Superior Garden View', checkIn: 'Dec 25, 2024', checkOut: 'Dec 27, 2024', nights: 2, amount: 400, status: 'confirmed' }
            ],
            weekly: Array(15).fill(null).map((_, i) => ({
                id: `BK${String(i + 1).padStart(3, '0')}`,
                guest: ['Emily Chen', 'Michael Brown', 'Sarah Johnson', 'David Lee', 'Anna Martinez'][i % 5],
                room: ['201', '105', '302', '203', '401'][i % 5],
                type: ['Deluxe Ocean Suite', 'Standard Room', 'Superior Garden View'][i % 3],
                checkIn: `Dec ${20 + (i % 7)}, 2024`,
                checkOut: `Dec ${22 + (i % 7)}, 2024`,
                nights: 2 + (i % 3),
                amount: 300 + (i * 50),
                status: ['confirmed', 'checked-in', 'checked-out'][i % 3]
            })),
            monthly: Array(45).fill(null).map((_, i) => ({
                id: `BK${String(i + 1).padStart(3, '0')}`,
                guest: ['Emily Chen', 'Michael Brown', 'Sarah Johnson', 'David Lee', 'Anna Martinez', 'James Wilson', 'Lisa Anderson'][i % 7],
                room: `${Math.floor(100 + Math.random() * 300)}`,
                type: ['Deluxe Ocean Suite', 'Standard Room', 'Superior Garden View'][i % 3],
                checkIn: `Dec ${1 + (i % 28)}, 2024`,
                checkOut: `Dec ${3 + (i % 28)}, 2024`,
                nights: 2 + (i % 4),
                amount: 200 + (i * 20),
                status: ['confirmed', 'checked-in', 'checked-out'][i % 3]
            })),
            quarterly: Array(120).fill(null).map((_, i) => ({
                id: `BK${String(i + 1).padStart(3, '0')}`,
                guest: ['Emily Chen', 'Michael Brown', 'Sarah Johnson', 'David Lee', 'Anna Martinez'][i % 5],
                room: `${Math.floor(100 + Math.random() * 300)}`,
                type: ['Deluxe Ocean Suite', 'Standard Room', 'Superior Garden View'][i % 3],
                checkIn: `${['Oct', 'Nov', 'Dec'][Math.floor(i / 40)]} ${1 + (i % 28)}, 2024`,
                checkOut: `${['Oct', 'Nov', 'Dec'][Math.floor(i / 40)]} ${3 + (i % 28)}, 2024`,
                nights: 2 + (i % 4),
                amount: 250 + (i * 15),
                status: ['confirmed', 'checked-in', 'checked-out'][i % 3]
            })),
            yearly: Array(450).fill(null).map((_, i) => ({
                id: `BK${String(i + 1).padStart(4, '0')}`,
                guest: ['Emily Chen', 'Michael Brown', 'Sarah Johnson', 'David Lee', 'Anna Martinez'][i % 5],
                room: `${Math.floor(100 + Math.random() * 300)}`,
                type: ['Deluxe Ocean Suite', 'Standard Room', 'Superior Garden View'][i % 3],
                checkIn: `${['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][Math.floor(i / 40)]} ${1 + (i % 28)}, 2024`,
                checkOut: `${['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'][Math.floor(i / 40)]} ${3 + (i % 28)}, 2024`,
                nights: 2 + (i % 5),
                amount: 200 + (i * 10),
                status: ['confirmed', 'checked-in', 'checked-out'][i % 3]
            }))
        };

        // Modal functions
        function openBookingSummaryModal() {
            document.getElementById('bookingSummaryModal').classList.add('show');
            generateBookingPreview();
        }

        function openRevenueReportModal() {
            document.getElementById('revenueReportModal').classList.add('show');
            generateRevenuePreview();
        }

        function openOccupancyReportModal() {
            document.getElementById('occupancyReportModal').classList.add('show');
            generateOccupancyPreview();
        }

        function openGuestReportModal() {
            document.getElementById('guestReportModal').classList.add('show');
            generateGuestPreview();
        }

        function openOperationsReportModal() {
            document.getElementById('operationsReportModal').classList.add('show');
            generateOperationsPreview();
        }

        function openFinancialReportModal() {
            document.getElementById('financialReportModal').classList.add('show');
            generateFinancialPreview();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        function selectPeriod(period, element) {
            selectedPeriod = period;
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
            generateBookingPreview();
        }

        function generateBookingPreview() {
            const data = bookingsData[selectedPeriod];
            const totalAmount = data.reduce((sum, booking) => sum + booking.amount, 0);
            const totalNights = data.reduce((sum, booking) => sum + booking.nights, 0);
            const avgAmount = (totalAmount / data.length).toFixed(2);
            
            const periodTitles = {
                daily: 'Daily Booking Report - December 25, 2024',
                weekly: 'Weekly Booking Report - Dec 20-26, 2024',
                monthly: 'Monthly Booking Report - December 2024',
                quarterly: 'Quarterly Booking Report - Q4 2024',
                yearly: 'Yearly Booking Report - 2024'
            };

            let html = `
                <div class="report-header-print">
                    <h2>${periodTitles[selectedPeriod]}</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">${data.length}</div>
                        <div class="stat-label">Total Bookings</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${totalNights}</div>
                        <div class="stat-label">Total Nights</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${totalAmount.toLocaleString()}</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${avgAmount}</div>
                        <div class="stat-label">Average Booking</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Booking Details</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Guest Name</th>
                                <th>Room</th>
                                <th>Room Type</th>
                                <th>Check-in</th>
                                <th>Check-out</th>
                                <th>Nights</th>
                                <th>Amount</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            // Limit display based on period
            const displayLimit = selectedPeriod === 'daily' ? data.length : 
                                selectedPeriod === 'weekly' ? 15 : 
                                selectedPeriod === 'monthly' ? 30 : 
                                selectedPeriod === 'quarterly' ? 50 : 100;

            data.slice(0, displayLimit).forEach(booking => {
                html += `
                    <tr>
                        <td><strong>${booking.id}</strong></td>
                        <td>${booking.guest}</td>
                        <td>${booking.room}</td>
                        <td>${booking.type}</td>
                        <td>${booking.checkIn}</td>
                        <td>${booking.checkOut}</td>
                        <td>${booking.nights}</td>
                        <td><strong>${booking.amount}</strong></td>
                        <td><span class="status-badge status-${booking.status}">${booking.status}</span></td>
                    </tr>
                `;
            });

            if (data.length > displayLimit) {
                html += `
                    <tr>
                        <td colspan="9" style="text-align: center; color: #64748b; font-style: italic;">
                            ... and ${data.length - displayLimit} more bookings
                        </td>
                    </tr>
                `;
            }

            html += `
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Summary by Room Type</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Room Type</th>
                                <th>Bookings</th>
                                <th>Total Nights</th>
                                <th>Total Revenue</th>
                                <th>Avg. Rate/Night</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            const byRoomType = {};
            data.forEach(booking => {
                if (!byRoomType[booking.type]) {
                    byRoomType[booking.type] = { count: 0, nights: 0, revenue: 0 };
                }
                byRoomType[booking.type].count++;
                byRoomType[booking.type].nights += booking.nights;
                byRoomType[booking.type].revenue += booking.amount;
            });

            Object.entries(byRoomType).forEach(([type, stats]) => {
                const avgRate = (stats.revenue / stats.nights).toFixed(2);
                html += `
                    <tr>
                        <td><strong>${type}</strong></td>
                        <td>${stats.count}</td>
                        <td>${stats.nights}</td>
                        <td>${stats.revenue.toLocaleString()}</td>
                        <td>${avgRate}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Summary by Status</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Count</th>
                                <th>Percentage</th>
                                <th>Total Revenue</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            const byStatus = {};
            data.forEach(booking => {
                if (!byStatus[booking.status]) {
                    byStatus[booking.status] = { count: 0, revenue: 0 };
                }
                byStatus[booking.status].count++;
                byStatus[booking.status].revenue += booking.amount;
            });

            Object.entries(byStatus).forEach(([status, stats]) => {
                const percentage = ((stats.count / data.length) * 100).toFixed(1);
                html += `
                    <tr>
                        <td><span class="status-badge status-${status}">${status}</span></td>
                        <td>${stats.count}</td>
                        <td>${percentage}%</td>
                        <td>${stats.revenue.toLocaleString()}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('bookingReportContent').innerHTML = html;
        }

        function generateRevenuePreview() {
            const html = `
                <div class="report-header-print">
                    <h2>Revenue Report - December 2024</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">$125,480</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">$95,200</div>
                        <div class="stat-label">Room Revenue</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">$30,280</div>
                        <div class="stat-label">Services Revenue</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">$185</div>
                        <div class="stat-label">ADR</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Revenue Breakdown by Category</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Percentage</th>
                                <th>vs Last Month</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Room Revenue</strong></td>
                                <td>$95,200</td>
                                <td>75.9%</td>
                                <td style="color: #10b981;">+12.5%</td>
                            </tr>
                            <tr>
                                <td><strong>Food & Beverage</strong></td>
                                <td>$18,450</td>
                                <td>14.7%</td>
                                <td style="color: #10b981;">+8.3%</td>
                            </tr>
                            <tr>
                                <td><strong>Spa Services</strong></td>
                                <td>$6,230</td>
                                <td>5.0%</td>
                                <td style="color: #10b981;">+15.2%</td>
                            </tr>
                            <tr>
                                <td><strong>Other Services</strong></td>
                                <td>$5,600</td>
                                <td>4.5%</td>
                                <td style="color: #ef4444;">-3.8%</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>TOTAL</td>
                                <td>$125,480</td>
                                <td>100%</td>
                                <td style="color: #10b981;">+10.8%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Revenue by Room Type</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Room Type</th>
                                <th>Nights Sold</th>
                                <th>Revenue</th>
                                <th>ADR</th>
                                <th>RevPAR</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Deluxe Ocean Suite</td>
                                <td>245</td>
                                <td>$52,450</td>
                                <td>$214</td>
                                <td>$182</td>
                            </tr>
                            <tr>
                                <td>Superior Garden View</td>
                                <td>198</td>
                                <td>$29,700</td>
                                <td>$150</td>
                                <td>$127</td>
                            </tr>
                            <tr>
                                <td>Standard Room</td>
                                <td>132</td>
                                <td>$13,050</td>
                                <td>$99</td>
                                <td>$84</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Daily Revenue Trend</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Week</th>
                                <th>Room Revenue</th>
                                <th>Service Revenue</th>
                                <th>Total Revenue</th>
                                <th>Occupancy</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Week 1 (Dec 1-7)</td>
                                <td>$18,450</td>
                                <td>$5,820</td>
                                <td>$24,270</td>
                                <td>68%</td>
                            </tr>
                            <tr>
                                <td>Week 2 (Dec 8-14)</td>
                                <td>$21,340</td>
                                <td>$6,450</td>
                                <td>$27,790</td>
                                <td>75%</td>
                            </tr>
                            <tr>
                                <td>Week 3 (Dec 15-21)</td>
                                <td>$26,780</td>
                                <td>$8,230</td>
                                <td>$35,010</td>
                                <td>89%</td>
                            </tr>
                            <tr>
                                <td>Week 4 (Dec 22-28)</td>
                                <td>$28,630</td>
                                <td>$9,780</td>
                                <td>$38,410</td>
                                <td>95%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('revenueReportContent').innerHTML = html;
        }

        function generateOccupancyPreview() {
            const html = `
                <div class="report-header-print">
                    <h2>Occupancy Report - December 2024</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">78%</div>
                        <div class="stat-label">Avg Occupancy</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">575</div>
                        <div class="stat-label">Nights Sold</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">50</div>
                        <div class="stat-label">Total Rooms</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">1,550</div>
                        <div class="stat-label">Available Nights</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Weekly Occupancy Breakdown</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Week</th>
                                <th>Available Rooms</th>
                                <th>Rooms Sold</th>
                                <th>Occupancy %</th>
                                <th>vs Last Year</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Week 1 (Dec 1-7)</td>
                                <td>350</td>
                                <td>238</td>
                                <td>68%</td>
                                <td style="color: #10b981;">+5%</td>
                            </tr>
                            <tr>
                                <td>Week 2 (Dec 8-14)</td>
                                <td>350</td>
                                <td>263</td>
                                <td>75%</td>
                                <td style="color: #10b981;">+8%</td>
                            </tr>
                            <tr>
                                <td>Week 3 (Dec 15-21)</td>
                                <td>350</td>
                                <td>312</td>
                                <td>89%</td>
                                <td style="color: #10b981;">+12%</td>
                            </tr>
                            <tr>
                                <td>Week 4 (Dec 22-28)</td>
                                <td>350</td>
                                <td>333</td>
                                <td>95%</td>
                                <td style="color: #10b981;">+15%</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>TOTAL</td>
                                <td>1,400</td>
                                <td>1,146</td>
                                <td>82%</td>
                                <td style="color: #10b981;">+10%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Occupancy by Room Type</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Room Type</th>
                                <th>Total Rooms</th>
                                <th>Available Nights</th>
                                <th>Nights Sold</th>
                                <th>Occupancy %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Deluxe Ocean Suite</td>
                                <td>15</td>
                                <td>465</td>
                                <td>395</td>
                                <td style="color: #10b981; font-weight: 600;">85%</td>
                            </tr>
                            <tr>
                                <td>Superior Garden View</td>
                                <td>20</td>
                                <td>620</td>
                                <td>484</td>
                                <td style="color: #10b981; font-weight: 600;">78%</td>
                            </tr>
                            <tr>
                                <td>Standard Room</td>
                                <td>15</td>
                                <td>465</td>
                                <td>335</td>
                                <td style="color: #f59e0b; font-weight: 600;">72%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Day of Week Analysis</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Avg Occupancy</th>
                                <th>Nights</th>
                                <th>Trend</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Monday</td>
                                <td>65%</td>
                                <td>130</td>
                                <td style="color: #64748b;">Stable</td>
                            </tr>
                            <tr>
                                <td>Tuesday</td>
                                <td>68%</td>
                                <td>136</td>
                                <td style="color: #10b981;">Improving</td>
                            </tr>
                            <tr>
                                <td>Wednesday</td>
                                <td>72%</td>
                                <td>144</td>
                                <td style="color: #10b981;">Improving</td>
                            </tr>
                            <tr>
                                <td>Thursday</td>
                                <td>78%</td>
                                <td>156</td>
                                <td style="color: #10b981;">Strong</td>
                            </tr>
                            <tr>
                                <td>Friday</td>
                                <td>92%</td>
                                <td>184</td>
                                <td style="color: #10b981;">Strong</td>
                            </tr>
                            <tr>
                                <td>Saturday</td>
                                <td>98%</td>
                                <td>196</td>
                                <td style="color: #10b981;">Peak</td>
                            </tr>
                            <tr>
                                <td>Sunday</td>
                                <td>85%</td>
                                <td>170</td>
                                <td style="color: #10b981;">Strong</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('occupancyReportContent').innerHTML = html;
        }

        function generateGuestPreview() {
            const html = `
                <div class="report-header-print">
                    <h2>Guest Analytics Report - December 2024</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">245</div>
                        <div class="stat-label">Total Guests</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">68</div>
                        <div class="stat-label">Returning Guests</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">4.6</div>
                        <div class="stat-label">Avg Rating</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">3.2</div>
                        <div class="stat-label">Avg Stay Length</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Guest Demographics</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Count</th>
                                <th>Percentage</th>
                                <th>Avg Spend</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>By Guest Type</strong></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Business Travelers</td>
                                <td>98</td>
                                <td>40%</td>
                                <td>$425</td>
                            </tr>
                            <tr>
                                <td>Leisure Travelers</td>
                                <td>122</td>
                                <td>50%</td>
                                <td>$520</td>
                            </tr>
                            <tr>
                                <td>Groups/Events</td>
                                <td>25</td>
                                <td>10%</td>
                                <td>$380</td>
                            </tr>
                            <tr>
                                <td><strong>By Region</strong></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Domestic</td>
                                <td>147</td>
                                <td>60%</td>
                                <td>$415</td>
                            </tr>
                            <tr>
                                <td>International</td>
                                <td>98</td>
                                <td>40%</td>
                                <td>$565</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Guest Satisfaction Ratings</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Rating</th>
                                <th>Reviews</th>
                                <th>Trend</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Overall Experience</td>
                                <td>4.6/5.0</td>
                                <td>187</td>
                                <td style="color: #10b981;">+0.3</td>
                            </tr>
                            <tr>
                                <td>Room Quality</td>
                                <td>4.7/5.0</td>
                                <td>192</td>
                                <td style="color: #10b981;">+0.2</td>
                            </tr>
                            <tr>
                                <td>Service Quality</td>
                                <td>4.8/5.0</td>
                                <td>185</td>
                                <td style="color: #10b981;">+0.4</td>
                            </tr>
                            <tr>
                                <td>Cleanliness</td>
                                <td>4.9/5.0</td>
                                <td>195</td>
                                <td style="color: #64748b;">0.0</td>
                            </tr>
                            <tr>
                                <td>Value for Money</td>
                                <td>4.3/5.0</td>
                                <td>178</td>
                                <td style="color: #ef4444;">-0.1</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Repeat Guest Analysis</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Visit Frequency</th>
                                <th>Guests</th>
                                <th>Avg Spend</th>
                                <th>Loyalty Tier</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>First Time</td>
                                <td>177 (72%)</td>
                                <td>$445</td>
                                <td>-</td>
                            </tr>
                            <tr>
                                <td>2-3 Visits</td>
                                <td>45 (18%)</td>
                                <td>$520</td>
                                <td>Silver</td>
                            </tr>
                            <tr>
                                <td>4-6 Visits</td>
                                <td>18 (7%)</td>
                                <td>$640</td>
                                <td>Gold</td>
                            </tr>
                            <tr>
                                <td>7+ Visits</td>
                                <td>5 (2%)</td>
                                <td>$850</td>
                                <td>Platinum</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('guestReportContent').innerHTML = html;
        }

        function generateOperationsPreview() {
            const html = `
                <div class="report-header-print">
                    <h2>Operations Report - December 2024</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">98.5%</div>
                        <div class="stat-label">Room Clean Rate</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">24</div>
                        <div class="stat-label">Maintenance Tasks</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">18 min</div>
                        <div class="stat-label">Avg Response Time</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">95%</div>
                        <div class="stat-label">Staff Efficiency</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Housekeeping Performance</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Metric</th>
                                <th>Target</th>
                                <th>Actual</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Rooms Cleaned per Day</td>
                                <td>45</td>
                                <td>48</td>
                                <td style="color: #10b981;">Above Target</td>
                            </tr>
                            <tr>
                                <td>Avg Clean Time (minutes)</td>
                                <td>30</td>
                                <td>28</td>
                                <td style="color: #10b981;">Above Target</td>
                            </tr>
                            <tr>
                                <td>Quality Score</td>
                                <td>95%</td>
                                <td>97%</td>
                                <td style="color: #10b981;">Above Target</td>
                            </tr>
                            <tr>
                                <td>Guest Complaints</td>
                                <td>&lt;5</td>
                                <td>3</td>
                                <td style="color: #10b981;">On Target</td>
                            </tr>
                            <tr>
                                <td>Staff Attendance</td>
                                <td>95%</td>
                                <td>96%</td>
                                <td style="color: #10b981;">On Target</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Maintenance Summary</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Tasks</th>
                                <th>Completed</th>
                                <th>Pending</th>
                                <th>Avg Resolution Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Plumbing</td>
                                <td>8</td>
                                <td>7</td>
                                <td>1</td>
                                <td>2.5 hours</td>
                            </tr>
                            <tr>
                                <td>Electrical</td>
                                <td>5</td>
                                <td>5</td>
                                <td>0</td>
                                <td>1.8 hours</td>
                            </tr>
                            <tr>
                                <td>HVAC</td>
                                <td>6</td>
                                <td>6</td>
                                <td>0</td>
                                <td>3.2 hours</td>
                            </tr>
                            <tr>
                                <td>General Repairs</td>
                                <td>5</td>
                                <td>4</td>
                                <td>1</td>
                                <td>1.5 hours</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>TOTAL</td>
                                <td>24</td>
                                <td>22</td>
                                <td>2</td>
                                <td>2.3 hours</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Staff Performance</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Department</th>
                                <th>Staff Count</th>
                                <th>Avg Rating</th>
                                <th>Training Hours</th>
                                <th>Overtime Hours</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Housekeeping</td>
                                <td>12</td>
                                <td>4.7/5.0</td>
                                <td>24</td>
                                <td>18</td>
                            </tr>
                            <tr>
                                <td>Front Desk</td>
                                <td>6</td>
                                <td>4.8/5.0</td>
                                <td>16</td>
                                <td>12</td>
                            </tr>
                            <tr>
                                <td>Maintenance</td>
                                <td>4</td>
                                <td>4.6/5.0</td>
                                <td>20</td>
                                <td>28</td>
                            </tr>
                            <tr>
                                <td>Food & Beverage</td>
                                <td>8</td>
                                <td>4.7/5.0</td>
                                <td>18</td>
                                <td>22</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Supply Inventory Status</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Current Stock</th>
                                <th>Monthly Usage</th>
                                <th>Reorder Level</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Linens</td>
                                <td>850 sets</td>
                                <td>320 sets</td>
                                <td>400 sets</td>
                                <td style="color: #10b981;">Good</td>
                            </tr>
                            <tr>
                                <td>Toiletries</td>
                                <td>1,200 units</td>
                                <td>980 units</td>
                                <td>500 units</td>
                                <td style="color: #10b981;">Good</td>
                            </tr>
                            <tr>
                                <td>Cleaning Supplies</td>
                                <td>145 units</td>
                                <td>125 units</td>
                                <td>150 units</td>
                                <td style="color: #f59e0b;">Low</td>
                            </tr>
                            <tr>
                                <td>Beverages</td>
                                <td>380 units</td>
                                <td>420 units</td>
                                <td>300 units</td>
                                <td style="color: #10b981;">Good</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('operationsReportContent').innerHTML = html;
        }

        function generateFinancialPreview() {
            const html = `
                <div class="report-header-print">
                    <h2>Financial Summary Report - December 2024</h2>
                    <p class="subtitle">Demo Link Hotel</p>
                    <p class="subtitle">Generated on ${new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                </div>

                <div class="stats-summary">
                    <div class="stat-box">
                        <div class="stat-value">$125,480</div>
                        <div class="stat-label">Total Revenue</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">$78,250</div>
                        <div class="stat-label">Operating Costs</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">$47,230</div>
                        <div class="stat-label">Net Profit</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">37.6%</div>
                        <div class="stat-label">Profit Margin</div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">Revenue Breakdown</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>% of Total</th>
                                <th>vs Budget</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Room Revenue</td>
                                <td>$95,200</td>
                                <td>75.9%</td>
                                <td style="color: #10b981;">+8.5%</td>
                            </tr>
                            <tr>
                                <td>Food & Beverage</td>
                                <td>$18,450</td>
                                <td>14.7%</td>
                                <td style="color: #10b981;">+5.2%</td>
                            </tr>
                            <tr>
                                <td>Spa & Wellness</td>
                                <td>$6,230</td>
                                <td>5.0%</td>
                                <td style="color: #10b981;">+12.3%</td>
                            </tr>
                            <tr>
                                <td>Other Services</td>
                                <td>$5,600</td>
                                <td>4.5%</td>
                                <td style="color: #ef4444;">-2.8%</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>TOTAL REVENUE</td>
                                <td>$125,480</td>
                                <td>100%</td>
                                <td style="color: #10b981;">+7.8%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Operating Expenses</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>% of Revenue</th>
                                <th>vs Budget</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Payroll & Benefits</td>
                                <td>$42,150</td>
                                <td>33.6%</td>
                                <td style="color: #10b981;">-2.3%</td>
                            </tr>
                            <tr>
                                <td>Utilities</td>
                                <td>$8,450</td>
                                <td>6.7%</td>
                                <td style="color: #ef4444;">+4.5%</td>
                            </tr>
                            <tr>
                                <td>Supplies & Amenities</td>
                                <td>$12,680</td>
                                <td>10.1%</td>
                                <td style="color: #10b981;">-1.2%</td>
                            </tr>
                            <tr>
                                <td>Maintenance & Repairs</td>
                                <td>$5,230</td>
                                <td>4.2%</td>
                                <td style="color: #10b981;">-3.8%</td>
                            </tr>
                            <tr>
                                <td>Marketing & Sales</td>
                                <td>$4,120</td>
                                <td>3.3%</td>
                                <td style="color: #64748b;">0.0%</td>
                            </tr>
                            <tr>
                                <td>Administrative</td>
                                <td>$3,850</td>
                                <td>3.1%</td>
                                <td style="color: #10b981;">-1.5%</td>
                            </tr>
                            <tr>
                                <td>Other Operating Costs</td>
                                <td>$1,770</td>
                                <td>1.4%</td>
                                <td style="color: #64748b;">0.0%</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>TOTAL EXPENSES</td>
                                <td>$78,250</td>
                                <td>62.4%</td>
                                <td style="color: #10b981;">-1.8%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Profit & Loss Statement</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>% of Revenue</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Total Revenue</strong></td>
                                <td>$125,480</td>
                                <td>100.0%</td>
                            </tr>
                            <tr>
                                <td><strong>Total Operating Expenses</strong></td>
                                <td>($78,250)</td>
                                <td>62.4%</td>
                            </tr>
                            <tr style="background: #f8fafc;">
                                <td><strong>Operating Profit (EBITDA)</strong></td>
                                <td><strong>$47,230</strong></td>
                                <td><strong>37.6%</strong></td>
                            </tr>
                            <tr>
                                <td>Depreciation</td>
                                <td>($3,200)</td>
                                <td>2.6%</td>
                            </tr>
                            <tr>
                                <td>Interest Expense</td>
                                <td>($1,850)</td>
                                <td>1.5%</td>
                            </tr>
                            <tr style="background: #f8fafc; font-weight: 600; color: #10b981;">
                                <td><strong>Net Profit</strong></td>
                                <td><strong>$42,180</strong></td>
                                <td><strong>33.6%</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Cash Flow Summary</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Opening Cash Balance</td>
                                <td>$85,600</td>
                                <td>As of Dec 1, 2024</td>
                            </tr>
                            <tr>
                                <td>Cash from Operations</td>
                                <td style="color: #10b981;">+$118,300</td>
                                <td>Revenue collected</td>
                            </tr>
                            <tr>
                                <td>Operating Expenses Paid</td>
                                <td style="color: #ef4444;">-$76,450</td>
                                <td>Monthly payments</td>
                            </tr>
                            <tr>
                                <td>Capital Expenditures</td>
                                <td style="color: #ef4444;">-$12,500</td>
                                <td>Equipment upgrades</td>
                            </tr>
                            <tr style="font-weight: 600; background: #f8fafc;">
                                <td>Closing Cash Balance</td>
                                <td>$114,950</td>
                                <td>As of Dec 31, 2024</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h3 class="section-title">Key Financial Ratios</h3>
                    <table class="bookings-table">
                        <thead>
                            <tr>
                                <th>Ratio</th>
                                <th>Value</th>
                                <th>Industry Avg</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Gross Profit Margin</td>
                                <td>37.6%</td>
                                <td>35%</td>
                                <td style="color: #10b981;">Above Average</td>
                            </tr>
                            <tr>
                                <td>Operating Expense Ratio</td>
                                <td>62.4%</td>
                                <td>65%</td>
                                <td style="color: #10b981;">Better</td>
                            </tr>
                            <tr>
                                <td>RevPAR</td>
                                <td>$154</td>
                                <td>$145</td>
                                <td style="color: #10b981;">Above Average</td>
                            </tr>
                            <tr>
                                <td>GOPPAR</td>
                                <td>$58</td>
                                <td>$51</td>
                                <td style="color: #10b981;">Above Average</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('financialReportContent').innerHTML = html;
        }

        function downloadBookingReport() {
            alert('Downloading booking report as PDF...\n\nIn a real application, this would generate and download a PDF file with the report content.');
        }

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('show');
                }
            });
        });

        // Initialize booking preview on page load
        generateBookingPreview();

        console.log('Reports Center initialized');
    </script>
</body>
</html>